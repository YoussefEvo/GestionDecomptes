<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:sec="http://www.springframework.org/security/tags"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
      
    	<ui:composition template="/template/template.xhtml">
    		<ui:define name="content">
    			<h:outputScript>
    				jQuery(document).ready(function(){
    					jQuery('li#navigationMarche').addClass("active open");
    					jQuery('li#navigationMarcheDecompte').addClass("active");
    				});
				</h:outputScript>
				<div class="page-content">
					<div class="page-header position-relative">
						<h:panelGrid columns="2">
							<h:form>
									<p:commandLink id="btnValid"  styleClass="btn btn-small btn-info"
												   onclick="activeLoading();" oncomplete="desactiveLoading();"
												   action="#{decompteController.startConsulterDecomptes}">
										<i class="icon-reply  icon-on-right bigger-110"></i>
										 
								</p:commandLink>
							</h:form>					
							<h1>
								#{i18n['message.navigation.marche']}
								<small>
								<i class="icon-double-angle-right"></i>
							 	#{i18n['message.navigation.decompte.consulter']}
								</small>
							</h1>
						</h:panelGrid>						
					</div><!--/.page-header-->
                    <div class="row-fluid">
                        <div class="span12">
                        <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />
							<h:form>
								<div class="ui-g" >
									<div class="ui-g-3" style="width: 300px;">
											<p:outputLabel for="numMarche" value="#{i18n['label.marche.numero']} :" />
											<p:inputText id="numMarche" value="#{decompteController.selectedMarche.numMarche}" readonly="true"/>
									<br /><br />
											<p:outputLabel for="numDecompte" value="#{i18n['label.decompte.numero']} :" />
											<p:inputText id="numDecompte" value="#{decompteController.decompte.numDecompte}" readonly="true"/>
											
											<h:panelGrid columns="2" style="margin-top: 16px;">
												<c:if test="#{decompteController.decompte.flagDernier eq i18n['label.decompte.definitif.partiel.code']}">
													<span class="label label-large label-success arrowed-in-right arrowed-in">
													#{i18n['label.decompte.definitif.partiel.code']}</span>											
												</c:if>
												<c:if test="#{decompteController.decompte.flagDernier eq i18n['label.decompte.definitif.global.code']}">
													<span class="label label-large label-info arrowed-in-right arrowed-in">
													#{i18n['label.decompte.definitif.global.code']}</span>											
												</c:if>
											</h:panelGrid>
										</div>
									
									<div class="ui-g-3" style="width: 300px;">
											<p:outputLabel for="fournisseur" value="#{i18n['label.marche.fournisseur']} :" />
											<p:inputText id="fournisseur" value="#{decompteController.selectedMarche.libFournisseur}"  readonly="true"/>
									<br /><br />
											<p:outputLabel for="dateEtablisement" value="#{i18n['label.date.etablile']} :" />
											<p:inputText id="dateEtablisement" readonly="true"
														 value="#{decompteController.decompte.dateEtablissement}">
												<f:convertDateTime pattern="dd/MM/yyyy" />
											</p:inputText>
									</div>
									
									<div class="ui-g-3" style="border-left: 3px dotted red;width: 300px;">
										<h:panelGrid columns="2">
											<p:outputLabel for="retenuGrantie" value="#{i18n['label.decompte.retenu.grantie']} :" />
											<p:inputText id="retenuGrantie" size="10" style="height: 13px"
														 value="#{decompteController.decompte.retenuGarantie}" readonly="true" >
														 <f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2"/>			 
											</p:inputText>
											<p:outputLabel for="penaliteRetard" value="#{i18n['label.decompte.penalite.retard']} :" />
											<p:inputText id="penaliteRetard" size="10" style="height: 13px"
														 value="#{decompteController.decompte.penaliteRetard}" readonly="true" >
														<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2"/>
											</p:inputText>
											<p:outputLabel for="retenuAvance" value="#{i18n['label.decompte.retenu.avance']} :" />
											<p:inputText id="retenuAvance" size="10" style="height: 13px"
														 value="#{decompteController.decompte.retenuAvance}" readonly="true" >
														<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2"/>
											</p:inputText>
											<p:outputLabel for="revisionPrix" value="#{i18n['label.decompte.revision.prix']} :" />
											<p:inputText id="revisionPrix" size="10" style="height: 13px"
														 value="#{decompteController.decompte.revisionPrix}" readonly="true" >
														<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2"/>
											</p:inputText>
											<p:outputLabel for="retenuAutre" value="#{i18n['label.decompte.retenu.autre']} :" />
											<p:inputText id="retenuAutre" size="10" style="height: 13px"
														 value="#{decompteController.decompte.autresRetenues}" readonly="true" >
														<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2"/>
											</p:inputText>
											<p:outputLabel for="retenuSource" value="#{i18n['label.decompte.retenu.source']} :" />
											<p:inputText id="retenuSource" size="10" style="height: 13px"
														 value="#{decompteController.decompte.retenueSource}" readonly="true" >
														<f:convertNumber type="number" minFractionDigits="2" maxFractionDigits="2"/>
											</p:inputText>																																		
										</h:panelGrid>	
									
									
									</div>
								</div>								
								<hr />
								<div class="fixedTable" >
										<p:dataTable id="tabMarche" emptyMessage="#{i18n['table.liste.vide']}"
													 sortBy="#{attach.numAttachement}"
													 value="#{decompteController.listAttachements}" var="attach" >
												    																
				    						<p:column headerText="#{i18n['label.attach.numero']}">
				        						<h:outputText value="#{attach.numAttachement}" />
				    						</p:column>
				
											<p:column headerText="#{i18n['label.date.du']}">
			        							<h:outputText value="#{attach.dateDebut}" >
			        								<f:convertDateTime pattern="dd/MM/yyyy" />
			        							</h:outputText>
			    							</p:column>
			    							
											<p:column headerText="#{i18n['label.date.au']}">
			        							<h:outputText value="#{attach.dateFin}" >
			        								<f:convertDateTime pattern="dd/MM/yyyy" />
			        							</h:outputText>
			    							</p:column>
			    							
											<p:column headerText="#{i18n['label.marche.montant']}">
			        							<h:outputText value="#{attach.montant}" />
			    							</p:column>			    																    										    										    										    										    										    										    							
										</p:dataTable>
								</div>	  
										<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
						        			<p:commandButton value="#{i18n['message.oui']}" type="button" 
						        							 styleClass="ui-confirmdialog-yes"
						        			 				 icon="ui-icon-check">
						        			</p:commandButton>
						        			<p:commandButton value="#{i18n['message.non']}" type="button"
						        							 styleClass="ui-confirmdialog-no"
						        							 icon="ui-icon-close" />
						    			</p:confirmDialog>
							</h:form>
                        
                        
						<!--PAGE CONTENT ENDS-->
						</div><!--/.span-->
					</div><!--/.row-fluid-->
			   	</div><!--/.page-content-->
			</ui:define>
    	</ui:composition>

</html>